' Gambas class file

'    This file is part of vinstall-ng

'    vinstall-ng is free software: you can redistribute it and/or modify
'    it under the terms of the GNU General Public License as published by
'    the Free Software Foundation, either version 2 of the License, or
'    (at your option) any later version.

'    vinstall-ng  is distributed in the hope that it will be useful,
'    but WITHOUT ANY WARRANTY; without even the implied warranty of
'    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
'    GNU General Public License for more details.

'    You should have received a copy of the GNU General Public License
'    along with vinstall-ng.  If not, see <http://www.gnu.org/licenses/>.
'
'-= system services window =-

PUBLIC SUB Form_Open()

  ME.prepare_grid()
  ME.LIST_AVAILABLE_SERVICES()
END
PUBLIC SUB prepare_grid()
  
  ME.svServiceList.Columns.count = 4
  ME.svServiceList.Rows.Count = 3
  ME.svServiceList.Columns[0].Width = 24
  ME.svServiceList.Columns[1].Width = 32
  ME.svServiceList.Columns[2].Width = 200
  ME.svServiceList.Rows[1].Height = 12
  ME.svServiceList[0, 2].Text = ("Service")
  ME.svServiceList[0, 3].Text = ("Description")
  ME.svServiceList[0, 2].Alignment = Align.Center
  ME.svServiceList[0, 3].Alignment = Align.Center
  ME.svServiceList[0, 2].Font.Bold = TRUE
  ME.svServiceList[0, 3].Font.Bold = TRUE
  ME.svServiceList[0, 0].BackColor = Color.SelectedBackground
  ME.svServiceList[0, 1].BackColor = Color.SelectedBackground
  ME.svServiceList[0, 2].BackColor = Color.SelectedBackground
  ME.svServiceList[0, 3].BackColor = Color.SelectedBackground
  
END

PUBLIC SUB LIST_AVAILABLE_SERVICES()
  
  DIM irow AS Integer = 2
  DIM sFile AS String
  
  'FOR EACH sFile IN Dir(ClsGlobal.sTargetPath &/ "etc" &/ "rc.d" &/ "init.d", "*", gb.File)
  FOR EACH sFile IN Dir("/etc/rc.d/init.d", "*", gb.File) 
    svServiceList[irow, 2].Text = sFile
    INC irow
    INC svServiceList.Rows.Count
  NEXT 
    DEC svServiceList.Rows.Count
  'Message("Done")
  
END


PUBLIC FUNCTION GetNext() AS String
  
  RETURN "FDone"
  
  
END
PUBLIC SUB StartUp()
  
  
  
END
PUBLIC SUB OnExit()
  
  
  
END



PUBLIC SUB Form_Resize()

  WITH ME
    .svServiceList.Height = .ClientH - (.svServiceList.top + 12)
  END WITH 

END

PUBLIC SUB TextLabel1_Menu()

  MdlBootMngr.PROBE_SYSTEM_FOR_OS("LILO")

END
