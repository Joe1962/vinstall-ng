' Gambas class file
'    This file is part of vinstall-ng

'    vinstall-ng is free software: you can redistribute it and/or modify
'    it under the terms of the GNU General Public License as published by
'    the Free Software Foundation, either version 2 of the License, or
'    (at your option) any later version.

'    vinstall-ng  is distributed in the hope that it will be useful,
'    but WITHOUT ANY WARRANTY; without even the implied warranty of
'    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
'    GNU General Public License for more details.

'    You should have received a copy of the GNU General Public License
'    along with vinstall-ng.  If not, see <http://www.gnu.org/licenses/>.




PUBLIC SUB Form_Resize()

  WITH ME
    '.tlBanner.Width = .ClientWidth - 10
    .tlBanner.Move(4, 8, .ClientWidth - (.tlBanner.Left * 2))
    .hrsep.Move(.tlBanner.left, .tlBanner.top + .tlBanner.Height - (.hrsep.Height), .tlBanner.Width)
    .rbUseExisting.Move(.tlBanner.Left, .tlBanner.Top + .tlBanner.Height + 8)
    .rbEditPartitions.Move(.rbUseExisting.Left, .rbUseExisting.Top + .rbUseExisting.Height + 4)
    .tlChoiceExp.MOVE(4, .rbEditPartitions.top + .rbEditPartitions.Height + 8, .ClientWidth - (.tlChoiceExp.Left * 2), .ClientHeight - .tlChoiceExp.top - .rbEditPartitions.height)
    
    '.tlChoiceExp.Move(.rbEditPartitions.Left, .rbEditPartitions.top + .rbEditPartitions.Height * 4, .tlBanner.Width - 10)

    
  END WITH 

END

PUBLIC SUB Form_Open()
  MdlCore.WARN_STATUS("")
  ME.tlBanner.text = "<h3>" & ME.tlBanner.text & "</h3>"
FMain.FrmCurr = ME
FMain.tvPlan["Prep2"].Selected = TRUE
FMain.tvPlan["Prep2"].Picture = MdlCore.sNowPic
FMain.tvPlan["Prep1"].Picture = MdlCore.sDonePic

FMain.btback.Enabled = TRUE
FMain.btback.ForeColor = Color.Black
'FMain.frmNext = FrmPartSel
  WITH ME
    .rbEditPartitions.Width = MdlObjSizer.get_object_width(.rbEditPartitions.Text) + 24
    .rbUseExisting.Width = MdlObjSizer.get_object_width(.rbUseExisting.Text) + 24
  END WITH 
ME.rbUseExisting_Click()
MdlCore.warn_status_off()
END

PUBLIC SUB rbUseExisting_Click()

  ME.tlChoiceExp.Text = "<h3>" & rbUseExisting.Text & "</h3><br>" &
  ("Select this option if you already have a linux installation that you wish to overwrite or if a linux partition scheme exists in your hard disk.") & Space(1)&
  "<b>" & ("This option will overwrite any existing data in the selected partitions") & "</b><br><br>" &
  "<i>" & ("Use this option if you already prepared your partitions using the VectorLinux installer") & "</i> "
  FMain.frmNext = FrmPartSel
  FMain.btnext.Enabled = TRUE

END

PUBLIC SUB rbEditPartitions_Click()

  ME.tlChoiceExp.Text = "<h3>" & rbEditPartitions.Text & "</h3><br>" &
  ("Select this option is you wish to create, more or resize partitions in order to make room for your new VectorLinux installation.") & Space(1)&
  ("This option is the safest choice if you have other existing installations that you wish to keep.")
  FMain.frmNext = FrmDiskPart

END

PUBLIC SUB tlChoiceExp_MouseDown()

  

END


PUBLIC SUB Form_Hide()

'FMain.tvPlan["Prep1"].Picture = MdlCore.sDonePic

END

PUBLIC SUB Form_Show()

  Form_Open()

END
