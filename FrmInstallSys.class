' Gambas class file


'    This file is part of vinstall-ng

'    vinstall-ng is free software: you can redistribute it and/or modify
'    it under the terms of the GNU General Public License as published by
'    the Free Software Foundation, either version 2 of the License, or
'    (at your option) any later version.

'    vinstall-ng  is distributed in the hope that it will be useful,
'    but WITHOUT ANY WARRANTY; without even the implied warranty of
'    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
'    GNU General Public License for more details.

'    You should have received a copy of the GNU General Public License
'    along with vinstall-ng.  If not, see <http://www.gnu.org/licenses/>.


PUBLIC SUB BEGIN_PROCESS()
  
   DIM sRes AS Integer ' we will need to 
   DIM sCredits AS String = DConv(File.Load(ClsGlobal.sSourceMnt &/ "CREDIT"))

  MdlCore.lock_gui()
  FMain.FrmCurr = ME
FMain.tvPlan["Inst0"].Picture = MdlCore.sDonePic
FMain.tvPlan["Inst1"].Picture = MdlCore.sNowPic
FMain.tvPlan["Inst1"].Selected = TRUE
  Message(sCredits)
  ' LOAD CREDITS INTO THE TEXTLABEL
    FrmCredits.TextLabel1.text = "<b>" & "BROUGHT TO YOU BY" & "</b><br><br><br>" &
      sCredits
  RETURN 
  
MdlInstallSys.ACTIVATE_SWAP_SPACE() ' activate swap for the current install
   
MdlPartFrmt.PREPARE_ALL_PARTITIONS() ' formats partitions and mounts them
  
END





PUBLIC SUB Form_Open()
 


FMain.FrmCurr = ME
FMain.tvPlan["Inst0"].Picture = MdlCore.sDonePic
FMain.tvPlan["Inst1"].Picture = MdlCore.sNowPic
FMain.tvPlan["Inst1"].Selected = TRUE
ME.tlBanner.Text = "<h3>" & tlBanner.Text & "</h3>"

  

      ME.tlCurrStepLbl.Text = ("Current Step")



PRINT "Begin installation process"
' ' ' MdlSetup.BEGIN_INSTALLATION()

' run external credits here

  FrmCredits.Reparent(ME.embCredits)
  FrmCredits.Show


END

PUBLIC SUB Form_Show()

  Form_Open()

END


PUBLIC SUB HIDE_PROGRES_CONTROLS()
  
  WITH ME
    .tlCurrStepLbl.Visible = FALSE
    .pbInstallProg.Visible = FALSE
    .tlCurrPkg2.Visible = FALSE
    .pbInstallProg2.Visible = FALSE
  END WITH 
  
END
