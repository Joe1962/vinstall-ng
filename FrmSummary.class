' Gambas class file


PUBLIC SUB Form_Open()


    IF ClsPkgSel.bCustom = TRUE THEN 
      ME.TextBox1.text = ("Custom")
      ME.Frame2.Visible = TRUE
      ME.prepare_packages_summary()
    ELSE 
      ME.TextBox1.text = ("Full")
      ME.Frame2.Visible = FALSE
      'ME.GridView2.Visible = FALSE
    END IF
ME.prepare_partition_summary()
  
  

END
PUBLIC SUB prepare_partition_summary()
    DIM iRow AS Integer = 0
    DIM cb AS ComboBox
    DIM cb1 AS ComboBox
    DIM sPart, sMountPnt, sFsType, sSize AS String
  
    ME.GridView1.Columns.count = 4
        ME.GridView1.Columns[0].text = ("Partition")
        ME.GridView1.Columns[0].Width = MdlObjSizer.get_object_width("/dev/hda1***")
        ME.GridView1.Columns[1].text = ("Size / GiB")
        ME.GridView1.Columns[1].Width = MdlObjSizer.get_object_width(ME.GridView1.Columns[1].text) * 1.5
        ME.GridView1.Columns[2].text = ("Filesystem")
        ME.GridView1.Columns[2].Width = MdlObjSizer.get_object_width(("Do Not Format")) * 1.5
        ME.GridView1.Columns[3].text = ("Mount Point")
        'ME.GridView1.Columns[3].Width = MdlObjSizer.get_object_width(ME.GridView1.Columns[3].text)

        ' tricky part to list the partitions on the summary
              FOR EACH cb IN MdlPartSel.oMountPoints
                
                IF cb.text <> ("Not Used") THEN 
                INC ME.GridView1.Rows.Count
                  sPart = cb.Tag
                  sMountPnt = cb.Text
                    FOR EACH cb1 IN MdlPartSel.oFsTypes
                      IF cb1.tag = cb.tag THEN sFsType = cb1.Text
                    NEXT 
                  WITH ME
                    .GridView1[irow, 0].text = sPart
                    .GridView1[irow, 1].text = sSize
                    .GridView1[irow, 2].text = sFsType
                    .GridView1[irow, 3].Text = sMountPnt
                  END WITH 
                INC irow ' increase this value... this determines the row to use.  
                END IF
                
              NEXT 
              
              ' ADD SWAP PARTITIONS HERE.
              
                      ' NEED TO ADD WINDOWS PARTITIONS HERE
                      ' MAYBE CREATE A SEPARATED ROW BY SETTING IT'S BG COLOR TO SOMETHING BRIGHT AND BOLD FORE FONTS
                      
                        
    
        
    
END

PUBLIC SUB prepare_packages_summary()
  
    DIM irow AS Integer = 0
    DIM sPkg, sSize AS String
    DIM cb AS CheckBox
    
      WITH ME.GridView2
      .Columns.count = 2
      .Columns[0].Title = ("Package Name")
      .Columns[0].Width = MdlObjSizer.get_object_width(.Columns[0].text) * 2.5
      .Columns[1].Title = ("Size / KiB")
      .Columns[1].Width = MdlObjSizer.get_object_width(.Columns[1].Text) * 1.5
      END WITH 
          
            ' add bulk packages
            FOR EACH cb IN MdlPkgSel.Bulks
              IF cb.Value = TRUE THEN 
                INC ME.GridView2.Rows.Count
                  GridView2[irow, 0].text = cb.Tag
                  
                  INC irow
              END IF
              
            NEXT 
      
END

