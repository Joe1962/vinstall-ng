' Gambas class file

'    This file is part of vinstall-ng

'    vinstall-ng is free software: you can redistribute it and/or modify
'    it under the terms of the GNU General Public License as published by
'    the Free Software Foundation, either version 2 of the License, or
'    (at your option) any later version.

'    vinstall-ng  is distributed in the hope that it will be useful,
'    but WITHOUT ANY WARRANTY; without even the implied warranty of
'    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
'    GNU General Public License for more details.

'    You should have received a copy of the GNU General Public License
'    along with vinstall-ng.  If not, see <http://www.gnu.org/licenses/>.



PUBLIC SUB Form_Open()

DIM sText AS String

  FMain.FrmCurr = ME
  Fmain.tvPlan["Conf4"].Picture = MdlCore.sDonePic
  Fmain.tvPlan["Conf5"].Picture = MdlCore.sNowPic
  Fmain.tvPlan["Conf5"].Selected = TRUE
  
  tlbanner.text = "<b>" & tlbanner.text & "</b>"

  FMain.btback.Enabled = FALSE
  FMain.btback.ForeColor = Color.Gray
'  sText = ClsGlobal.DISTRO & Space(1) & ("is performing final system configuration. Please wait a moment.")
  FMain.btnext.Enabled = FALSE
  FMain.btQuit.Enabled = FALSE
  'REPEAT 
  ' '   IF MdlConfLilo.hBgConfigProc.State = Process.Running THEN 
  ' '       REPEAT 
  ' '         WAIT 
  ' '   'IF ME.MONITOR_BACKGROUND() = 1 THEN 
  ' '         ME.tlMsg.Text = sText
  ' '       UNTIL MdlConfLilo.hBgConfigProc.State = Process.Stopped
  ' '   END IF
  ' '   
  ' '     sText = ClsGlobal.DISTRO & Space(1) & ("has been installed to your system. Your new system has been configured with the default factory settings.") & "<br><br>" &
  ' '    ("After reboot you can use vasm or vasmCC to fine tune your installation.") & "<br><br>" &
  ' '   ("Your computer needs to be restarted so that you can use your new operating system. Click") & Space(1) & FMain.btnext.text & Space(1)&
  ' '    ("to restart your computer now or click") & Space(1) & FMain.btQuit.Text & Space(1) & ("to restart your computer at a later time") & "<br><br" &
  ' '    ("If you installed from  CD-ROM/R/RW media, please remove de disk before restarting.")
  ' '   
  ' ' ME.tlMsg.Text = sText
  ' ' FMain.btnext.Enabled = TRUE
  ' ' FMain.btQuit.Enabled = TRUE
  'MdlSetup.END_INSTALLER()
  

END


PUBLIC SUB tmBgMon_Timer()

DIM sText AS String

      IF MdlConfLilo.hBgConfigProc.State = Process.Running THEN 
            sText = ClsGlobal.DISTRO & Space(1) & ("is performing final system configuration. Please wait a moment.")
            FMain.btnext.Enabled = FALSE
            FMain.btQuit.Enabled = FALSE
    ELSE 
    
      sText = ClsGlobal.DISTRO & Space(1) & ("has been installed to your system. Your new system has been configured with the default factory settings.") & "<br><br>" &
     ("After reboot you can use vasm or vasmCC to fine tune your installation.") & "<br><br>" &
    ("Your computer needs to be restarted so that you can use your new operating system. Click") & Space(1) & FMain.btnext.text & Space(1)&
     ("to restart your computer now or click") & Space(1) & FMain.btQuit.Text & Space(1) & ("to restart your computer at a later time") & "<br><br" &
     ("If you installed from  CD-ROM/R/RW media, please remove de disk before restarting.")
     FMain.btnext.Enabled = TRUE
     FMain.btQuit.Enabled = TRUE
     ME.tlMsg.Text = sText
     ME.tmBgMon.Enabled = FALSE
     
    END IF
  ME.tlMsg.Text = sText
  
  'FMain.btnext.Enabled = TRUE
  'FMain.btQuit.Enabled = TRUE

END
