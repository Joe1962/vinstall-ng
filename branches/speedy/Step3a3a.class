' Gambas class file

'    This file is part of vinstall-ng

'    vinstall-ng is free software: you can redistribute it and/or modify
'    it under the terms of the GNU General Public License as published by
'    the Free Software Foundation, either version 2 of the License, or
'    (at your option) any later version.

'    vinstall-ng  is distributed in the hope that it will be useful,
'    but WITHOUT ANY WARRANTY; without even the implied warranty of
'    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
'    GNU General Public License for more details.

'    You should have received a copy of the GNU General Public License
'    along with vinstall-ng.  If not, see <http://www.gnu.org/licenses/>.

PUBLIC SUB Form_Open()

  DIM sText AS String
  
  ME.tlExp.Text = "<h2>" & ME.tlExp.text & "</h2>"
  
    sText = ("You are about to shink") & Space(1) & MdlAutoPartition.sPartitionToShrink & Space(1) & ("to make room for your vectorlinux installation.") & Space(1)&
    ("This is generally a safe procedure, however, you should always consider making copies of your valuable data before making changes such as this one to your system")& 
    "<br><br>" & ("When you are ready to continue, click the") & Space(1) & "\"<b>" & btstart.Text & "\" </b>" & Space(1) & ("button.")
    ClsGlobal.fRunningMainForm.btnext.enabled = FALSE
  ME.tlWarning.Text = sText
  ME.tlbanner.Text = "<h2>" & ME.tlbanner.Text & "</h2>"
  ME.hbox2.Visible = FALSE
  

END

PUBLIC SUB OnExit()
  
  
  
END


PUBLIC FUNCTION GetNext() AS String
  
  RETURN "Step7"
  
END

PUBLIC SUB StartUP()

ME.btStart.Enabled = TRUE
ME.HBox2.Visible = FALSE
ME.tlWarning.Visible = TRUE
ME.MovieBox1.Enabled = TRUE

ClsGlobal.fRunningMainForm.btnext.enabled = FALSE  


  
END


PUBLIC SUB btStart_Click()

  ME.tlWarning.Visible = FALSE
  ME.HBox2.Visible = TRUE
  ME.MovieBox1.path = "images/throbber.gif"
  ME.tlExp.Text = ("Shrinking partitions and creating new environment for VectorLinux ... Please Wait")
  ME.MovieBox1.Playing = TRUE
  LAST.enabled = FALSE
  MdlAutoPartition.PERFORM_AUTO_PARTITION_FROM_FREE_SPACE(MdlAutoPartition.sPartitionToShrink)
  
  ME.tlExp.Text = ("Partitions are ready for VectorLinux. Click") & Space(1) & "\"" & ClsGlobal.fRunningMainForm.btnext.text & "\"" & Space(1) & ("to continue")    
  MovieBox1.Playing = FALSE
  ME.MovieBox1.Enabled = FALSE
  ClsGlobal.fRunningMainForm.btnext.enabled = TRUE
  
  'WAIT 10
  
  'ME.MovieBox1.Playing = FALSE
  'ClsGlobal.fRunningMainForm.btnext.enabled = TRUE
  
  
  

END
