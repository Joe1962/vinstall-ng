' Gambas class file

'    This file is part of vinstall-ng

'    vinstall-ng is free software: you can redistribute it and/or modify
'    it under the terms of the GNU General Public License as published by
'    the Free Software Foundation, either version 2 of the License, or
'    (at your option) any later version.

'    vinstall-ng  is distributed in the hope that it will be useful,
'    but WITHOUT ANY WARRANTY; without even the implied warranty of
'    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
'    GNU General Public License for more details.

'    You should have received a copy of the GNU General Public License
'    along with vinstall-ng.  If not, see <http://www.gnu.org/licenses/>.
'=====================================================================================




PUBLIC FUNCTION GetNext() AS String
  
  ClsGlobal.fRunningMainForm.listview1["Step6"].Picture = MdlStartUp.pNow
  ClsGlobal.fRunningMainForm.listview1["Step5"].picture = MdlStartUp.pDone
  ClsGlobal.fRunningMainForm.listview1["Step4"].picture = MdlStartUp.pDone
  
  RETURN "Conf1"
  
  
END
PUBLIC SUB StartUp()

'  MdlBootMngr.Display_Bootmanager_Target_Options()
  IF MdlBootMngr.bScanned = FALSE OR NOT MdlBootMngr.bScanned THEN 
    'MdlBootMngr.List_Other_Linuxes(ME.TsOSListing)
    ME.List_Found_Os_List(ME.TsOsListing)
    MdlBootMngr.List_Default_Boot_Choices(ME.cbBootDef)
  END IF
   
  
END

PUBLIC SUB List_Found_Os_List(objts AS TabStrip)
  
  MdlBootMngr.List_Other_Linuxes(objts)
  
END


PUBLIC SUB OnExit()
  
  
  
END



PUBLIC SUB Form_Open()

'  MdlBootMngr.trigger_default_boot_list
  

  WITH ME
    .tlbanner.Text = "<h2>" & tlbanner.text & "</h2>"
    .tlSep.Text = "<b>" & tlsep.Text & "</b>"
    .cbVidRes.List = [("Standard"), ("Bootplash Med"), ("Bootsplash High"), ("Bootsplash Extra High")]
  END WITH 

END

PUBLIC SUB Form_Resize()

  ME.HBox2.Width = ME.Frame1.Width - (ME.HBox2.Left * 2)
  ME.hbox3.Width = ME.Frame2.Width - (ME.HBox3.Left * 2)
  ME.HBox5.Width = ME.Frame2.Width - (ME.hbox5.Left * 2)
  ME.HBox6.Width = ME.Width
'  ME.TsOsListing.Height = ClsGlobal.fRunningMainForm.pnlstack.height - (ME.TsOsListing.Top + 230)

END

PUBLIC SUB rbNone_Click()

  IF LAST.value = TRUE THEN 
    Message.Warning("<b>" & ("WARNING:") & "</b><br>" &
    ("Selecting this option will bypass your boot manager configuration.") & "<br>" &
    ("You may not be able to start your VectorLinux installation. Do not choose this option") & "<br>" &
    ("unless you are fully aware of what you are doing."))
END IF

END

PUBLIC SUB tlLiloTarget_DblClick()

  Balloon("This is a test" & "<br>" & "This is another string" & "<br><br><br><br><br><br>" & "to see if the baloon has been fixed", cbLiloTarget)

END

PUBLIC SUB Form_Menu()

  MdlBootMngr.GENERATE_LILO_HEADER()

END

PUBLIC SUB HPanel1_Menu()



END

PUBLIC SUB tlbanner_Menu()


END

PUBLIC SUB Timer1_Timer()

  MdlBootMngr.List_Default_Boot_Choices(ME.cbBootDef)

END
