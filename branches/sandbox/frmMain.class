' Gambas class file

' ### MAIN WINDOW ###

PUBLIC flagStep AS Byte

PUBLIC SUB Form_Open()

' Can't set these here or title bitmap is duplicated on resize!
'picTitle.BackColor = Global.DefaultBackground
'picSlogan.BackColor = Global.DefaultBackground

'frmWelcome.Show

flagStep = 1
' Button1.Expand = TRUE
' Button2.Expand = TRUE
' Button3.Expand = TRUE
' Button4.Expand = TRUE
' Button5.Expand = TRUE
' Button6.Expand = TRUE
' Button7.Expand = TRUE
' butExit.Expand = TRUE

' Button2.Enabled = TRUE
' Button3.Enabled = FALSE
' Button4.Enabled = FALSE
' Button5.Enabled = FALSE
' Button6.Enabled = FALSE
' Button7.Enabled = FALSE
' butExit.Enabled = TRUE

END

PUBLIC SUB Form_Resize()
DIM x AS Integer, y AS Integer

picTitle.Move(0, 0, ME.ClientWidth, picTitle.Picture.Height + 8)
picSlogan.Move(0, ME.ClientHeight - picSlogan.Picture.Height - 10, ME.ClientWidth, picSlogan.Picture.Height + 10)
pnlSteps.Move(0, picTitle.Height, pnlSteps.Parent.ClientWidth, pnlSteps.Height)
pnlContainer.Move(0, pnlSteps.Y + pnlSteps.Height, ME.ClientWidth, picSlogan.Y - pnlContainer.Y)

END

PUBLIC SUB btnExit_Click()

ME.Close

END

PUBLIC SUB btnWelcome_Click()

IF Global.prevForm <> 1 THEN
   CloseForm(Global.prevForm)
   frmWelcome.Reparent(frmMain.pnlContainer, 0, 0)
   frmWelcome.Show
   Global.prevForm = 1
ENDIF

END

PUBLIC SUB btnChoice_Click()

IF Global.prevForm <> 2 THEN
   CloseForm(Global.prevForm)
   frmChoice.Reparent(frmMain.pnlContainer, 0, 0)
   frmChoice.Show
   Global.prevForm = 2
ENDIF

END

PUBLIC SUB btnPartitions_Click()

IF Global.prevForm <> 3 THEN
   CloseForm(Global.prevForm)
   frmPartitions.Reparent(frmMain.pnlContainer, 0, 0)
   frmPartitions.Show
   Global.prevForm = 3
ENDIF

END

PUBLIC SUB btnPackages_Click()

IF Global.prevForm <> 4 THEN
   CloseForm(Global.prevForm)
   frmPackages.Reparent(frmMain.pnlContainer, 0, 0)
   frmPackages.Show
   Global.prevForm = 4
ENDIF

END

PUBLIC SUB btnConfigure_Click()

IF Global.prevForm <> 5 THEN
   CloseForm(Global.prevForm)
   frmConfig.Reparent(frmMain.pnlContainer, 0, 0)
   frmConfig.Show
   Global.prevForm = 5
ENDIF

END

PUBLIC SUB btnGo_Click()

IF Global.prevForm <> 6 THEN
   CloseForm(Global.prevForm)
   frmGO.Reparent(frmMain.pnlContainer, 0, 0)
   frmGO.Show
   Global.prevForm = 6
ENDIF

END

PUBLIC SUB btnTools_Click()

IF Global.prevForm <> 7 THEN
   CloseForm(Global.prevForm)
   frmTools.Reparent(frmMain.pnlContainer, 0, 0)
   frmTools.Show
   Global.prevForm = 7
ENDIF

END

PUBLIC SUB CloseForm(frmNum AS Long)
' Close previous form to save mem.

SELECT CASE frmNum
CASE 1
   frmWelcome.Close
CASE 2
   frmChoice.Close
CASE 3
   frmPartitions.Close
CASE 4
   frmPackages.Close
CASE 5
   frmConfig.Close
CASE 6
   frmGO.Close
CASE 7
   frmTools.Close
END SELECT

END

PUBLIC SUB Form_Close()
DIM hWindow AS Window

FOR EACH hWindow IN Windows
   hWindow.Close
NEXT

END


