' Gambas class file

'    This file is part of vinstall-ng

'    vinstall-ng is free software: you can redistribute it and/or modify
'    it under the terms of the GNU General Public License as published by
'    the Free Software Foundation, either version 2 of the License, or
'    (at your option) any later version.

'    vinstall-ng  is distributed in the hope that it will be useful,
'    but WITHOUT ANY WARRANTY; without even the implied warranty of
'    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
'    GNU General Public License for more details.

'    You should have received a copy of the GNU General Public License
'    along with vinstall-ng.  If not, see <http://www.gnu.org/licenses/>.


PUBLIC SUB Form_Open()
  Fmain.frmcurr = ME
    ME.tlbanner.Text = "<h3>" & ("Timezone configuration") & "</h3>"
    WITH FMain
      .tvPlan["Conf0"].Picture = MdlCore.sDonePic
      .tvPlan["Conf1"].picture = MdlCore.sNowPic
      .tvPlan["Conf1"].Selected = TRUE
    END WITH 
      MdlCore.unlock_gui() ' unlock the back button
  FMain.btnext.Enabled = FALSE
  MdlZoneSet.TIME_ZONES()
  'ME.lbTmZone.Index = 9
END


PUBLIC SUB lbTmZone_Click()

  'Message(ME.lbTmZone.Text)
  FMain.btnext.Enabled = TRUE

END

' ' ' PUBLIC SUB Button1_Click()
' ' ' ' THis is not necessary, since the next button on the main window handles this
' ' ' 
' ' '   MdlZoneSet.SET_ZONE(ME.lbTmZone.Text)
' ' '   MdlZoneSet.WRITE_CONF()
' ' '   'Message("TimeZone " & ME.lbTmZone.Text & " Was set.")
' ' '   
' ' ' END

PUBLIC SUB Form_Resize()

  WITH ME
    '.Frame1.Move(4, 4, .ClientWidth - (.Frame1.left * 2), .ClientHeight - (.Frame1.top * 2))
    .tlbanner.Move(4, 4, .ClientWidth - (.tlbanner.Left * 2))
    .hrsep.Move(4, .tlbanner.top + .tlbanner.Height, .tlbanner.Width)
    .TextLabel1.Move(4, .hrsep.top + .hrsep.Height + 8, .hrsep.Width)
    .TextLabel1.Adjust
    .cbHwClock.Move(.TextLabel1.left, .TextLabel1.top + .TextLabel1.Height + 4, (.TextLabel1.width / 2), 21)
    .TextLabel2.Move(4, .cbHwClock.top + cbHwClock.Height + 8, .TextLabel1.Width)
    .lbTmZone.Move(4, .TextLabel2.top + .TextLabel2.Height + 4, .cbHwClock.Width)
    '.lbTmZone.Height = .Frame1.Height - (.TextLabel1.Height + .cbHwClock.Height + (.TextLabel2.Height * 4))
    .lbTmZone.Height = .ClientHeight - (.lbTmZone.top + .TextLabel1.Height)
    
    
    
    
  .TextLabel1.Adjust()
  END WITH 

END

PUBLIC SUB cbHwClock_Click()

  

END

PUBLIC SUB lbTmZone_KeyPress()


 
  DIM i AS Integer
  
  'i = 0
  IF Key.text > "z" OR Key.text < " " THEN RETURN  ' not searchable
  
    i = lbTmZone.Index
      DO
        INC i
          IF i >= lbTmZone.Count THEN i = 0 'back to top
          IF i = lbTmZone.Index THEN RETURN  ' no other match found
          IF lbTmZone[i].text LIKE Key.Text & "*" THEN 
          lbTmZone.Index = i
          RETURN 
          END IF
        LOOP 
' ' ' ' '       
' ' ' ' '     
' ' ' ' '   
' ' ' ' ' 'Message(lbTmZone[2].text)
' ' ' ' '   
' ' ' ' '   lbTmZone.Index = 0
' ' ' ' '     REPEAT 
' ' ' ' '       'INC lbTmZone.Index
' ' ' ' '       
' ' ' ' '         IF lbTmZone[lbTmZone.Index].text LIKE Key.Text & "*" THEN 
' ' ' ' '         
' ' ' ' '           'Message.Info(lbTmZone.text)
' ' ' ' '           BREAK 
' ' ' ' '         END IF
' ' ' ' '         INC lbTmZone.Index
' ' ' ' '         IF lbTmZone.Index = lbTmZone.Count THEN RETURN ' nothing found
' ' ' ' '       UNTIL lbTmZone.Index = lbTmZone.Count
' ' ' ' '     

  ' DIM iScan AS Integer
  '   IF Key.text > "z" OR Key.text < " " THEN RETURN '  not scannable
  '   
  '   iScan = lbTmZone.Index
  '     DO
  '       INC iScan
  '         IF iScan >= lbTmZone.Count THEN iScan = 0 ' back to top
  '         IF iScan = lbTmZone.Index THEN RETURN ' went back to were we started
  '         IF lbTmZone[iScan].text LIKE Key.text & "*[*]*" THEN  ' found a match
  '         lbTmZone.Index = iScan
  '         END IF
  '         RETURN 
  '       LOOP 
      

END

PUBLIC SUB Form_Show()

  Fmain.frmcurr = ME
    ME.tlbanner.Text = "<h3>" & ("Timezone configuration") & "</h3>"
    WITH FMain
      .tvPlan["Conf0"].Picture = MdlCore.sDonePic
      .tvPlan["Conf1"].picture = MdlCore.sNowPic
      .tvPlan["Conf1"].Selected = TRUE
    END WITH 
  

END
