' Gambas class file

'    This file is part of vinstall-ng

'    vinstall-ng is free software: you can redistribute it and/or modify
'    it under the terms of the GNU General Public License as published by
'    the Free Software Foundation, either version 2 of the License, or
'    (at your option) any later version.

'    vinstall-ng  is distributed in the hope that it will be useful,
'    but WITHOUT ANY WARRANTY; without even the implied warranty of
'    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
'    GNU General Public License for more details.

'    You should have received a copy of the GNU General Public License
'    along with vinstall-ng.  If not, see <http://www.gnu.org/licenses/>.

PUBLIC SUB Form_Open()

  ME.tlbanner.Text = "<h3>" & ("User Accounts") & "</h3>"
  ME.tlExp.Text = "<h3>" & ("Create initial user accounts") & "</h3><br>" &
  ("Click the button below to create a new user account.") & "<br>" &
  ("New user accounts can also be created after the install process is completed.")
  ME.tlExp.Visible = FALSE

  WITH FMain
    .FrmCurr = ME
    ' .tvPlan["Conf2"].Picture = MdlCore.sDonePic
    ' .tvPlan["Conf3"].picture = MdlCore.sNowPic
    ' .tvPlan["Conf3"].Selected = TRUE
  END WITH 
  
 
  ME.EMBED_VASMCC_MODULE()
    'btAddUser.Visible = FALSE
  
END


PUBLIC SUB EMBED_VASMCC_MODULE()
  
   DIM iID AS Integer = ME.Embedder1.Id
  
  SHELL "$PWD/adduser.gambas " & iID & Space(1) & ME.ClientWidth & Space(1) & ME.clientHeight
  MdlCore.LOCK_GUI()
  
  
END



PUBLIC SUB Form_Resize()

  WITH ME
    .tlbanner.Move(4, 4, .ClientWidth - (.tlbanner.Left * 2))
    .hrsep.Move(4, .tlbanner.top + (.tlbanner.Height - .hrsep.Height), .tlbanner.Width)
    .tlExp.Move(8, .hrsep.top + .hrsep.Height + 32, .ClientWidth - (.tlExp.Left * 2))
    
    .Embedder1.Move(4, .hrsep.top + .hrsep.Height + 8, .hrsep.Width, .clientHeight - ((.hrsep.top) + .tlbanner.Height + .btAddUser.Height + .hrsep.height))
    .btAddUser.Move(.ClientWidth / 2 - (.btAddUser.Width / 2), .tlExp.top + .tlExp.Height + 12, MdlObjSizer.get_object_width(.btAddUser.text) + 36)
   
    
  END WITH 

END

PUBLIC SUB Embedder1_Close()

  MdlCore.unlock_gui()
  btAddUser.Show
  Embedder1.Hide
  ME.tlExp.Show
  
  

END

PUBLIC SUB btAddUser_Click()

  ME.EMBED_VASMCC_MODULE()
  ME.Embedder1.show
  ME.btAddUser.Hide
  ME.tlExp.Hide
  'btAddUser.Visible = FALSE

END

PUBLIC SUB Embedder1_Leave()

  'ME.Embedder1.Visible = FALSE
  'btAddUser.Visible = TRUE
  Embedder1.Hide
  btAddUser.show
  'ME.Refresh

END

PUBLIC SUB Embedder1_Embed()

  'btAddUser.Visible = FALSE
  Embedder1.show
  btAddUser.Hide
  'btAddUser.lower
END
