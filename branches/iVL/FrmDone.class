' Gambas class file

'    This file is part of vinstall-ng

'    vinstall-ng is free software: you can redistribute it and/or modify
'    it under the terms of the GNU General Public License as published by
'    the Free Software Foundation, either version 2 of the License, or
'    (at your option) any later version.

'    vinstall-ng  is distributed in the hope that it will be useful,
'    but WITHOUT ANY WARRANTY; without even the implied warranty of
'    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
'    GNU General Public License for more details.

'    You should have received a copy of the GNU General Public License
'    along with vinstall-ng.  If not, see <http://www.gnu.org/licenses/>.



PUBLIC SUB Form_Open()

DIM sText AS String
ME.MovieBox1.Path = "images/throbber.gif"
ME.icon = picture["images/throbber.gif"]
  FMain.FrmCurr = ME
  Fmain.tvPlan["Conf4"].Picture = MdlCore.sDonePic
  Fmain.tvPlan["Conf5"].Picture = MdlCore.sNowPic
  Fmain.tvPlan["Conf5"].Selected = TRUE
  
  tlbanner.text = "<b>" & tlbanner.text & "</b>"

  FMain.btback.Enabled = FALSE
  FMain.btback.ForeColor = Color.Gray

  FMain.btnext.Enabled = FALSE
  FMain.btQuit.Enabled = FALSE

ME.tmBgMon.Enabled = TRUE  

END


PUBLIC SUB tmBgMon_Timer()

DIM sText AS String

      'IF MdlConfLilo.hBgConfigProc.State = Process.Running THEN 
      IF Exist(ClsGlobal.sTargetMnt &/ "tmp" &/ "status") = FALSE THEN 
        'Message.Info("Found /tmp/status")
        ME.tlBanner.Text = "<b>" & ("Configuration in progress") & "</b>"
            sText = "<br><br><br>" & ClsGlobal.DISTRO & Space(1) & ("is performing final system configuration. Please wait a moment.")
            FMain.btnext.Enabled = FALSE
            FMain.btQuit.Enabled = FALSE
            ME.MovieBox1.Playing = TRUE
    ELSE 
    'Message.Info("Found /tmp/status")
    ME.MovieBox1.Playing = FALSE
    ME.MovieBox1.Visible = FALSE
       FMain.btnext.Text = ("Restart")
       FMain.btnext.Width = MdlObjSizer.get_object_width(FMain.btnext.Text) + 36
    ME.tlBanner.Text = "<b>" & ("Installation is complete") & "</b>"
      sText = ClsGlobal.DISTRO & Space(1) & ("has been installed to your system. Your new system has been configured with the default factory settings.") & "<br><br>" &
     ("After reboot you can use vasm or vasmCC to fine tune your installation.") & "<br><br>" &
     ("Your computer needs to be restarted so that you can use your new operating system. Click") & Space(1) & FMain.btnext.text & Space(1)&
     ("to restart your computer now or click") & Space(1) & FMain.btQuit.Text & Space(1) & ("to restart your computer at a later time") & "<br><br" &
     ("If you installed from  CD-ROM/R/RW media, please remove de disk before restarting.")
     FMain.btnext.Enabled = TRUE
     FMain.btQuit.Enabled = TRUE
  
     ME.tlMsg.Text = sText
     ME.tmBgMon.Enabled = FALSE
     
    END IF
  ME.tlMsg.Text = sText
  

END

PUBLIC SUB Form_Show()

  ME.Form_Open()

END
