' Gambas class file

'    This file is part of vinstall-ng

'    vinstall-ng is free software: you can redistribute it and/or modify
'    it under the terms of the GNU General Public License as published by
'    the Free Software Foundation, either version 2 of the License, or
'    (at your option) any later version.

'    vinstall-ng  is distributed in the hope that it will be useful,
'    but WITHOUT ANY WARRANTY; without even the implied warranty of
'    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
'    GNU General Public License for more details.

'    You should have received a copy of the GNU General Public License
'    along with vinstall-ng.  If not, see <http://www.gnu.org/licenses/>.


PUBLIC SUB Form_Open()

   FMain.tvPlan["Conf0"].Selected = TRUE
   FMain.tvPlan["Conf0"].Picture = MdlCore.sNowPic
   FMain.tvPlan["Inst1"].Picture = MdlCore.sDonePic 

ME.tlBanner.Text = "<b>" & ME.tlBanner.Text & "</b>"
""
MdlConfLilo.DISPLAY_LILO_TARGET_OPTIONS()
ME.list_video_modes()
FMain.FrmCurr = ME

  MdlLilo.LIST_LINUX_OS()
  MdlLilo.LIST_WIN_INSTALLS()
  ME.CLEANUP_TABSTRIP()
  MdlLilo.LIST_DEFAULT_BOOT_OPTIONS() ' initial list
  FMain.btnext.Enabled = TRUE
  ME.cbVideoRes.text = ("Bootsplash High")
'    ME.cbBootDefault_Click
ME.cbVideoRes_Click()
  ME.cbBootDefault.Text = "VectorLinux"
  
END

PUBLIC SUB CLEANUP_TABSTRIP()
DIM i AS Integer


    ' will remove blank tabstrip
      FOR i = 0 TO ME.tsLIloTabs.Count
        tsLIloTabs.Index = i
          IF tsLIloTabs.Text = "" THEN 
            tsLIloTabs[i].Delete
            RETURN 
          END IF
          
      NEXT 
  ' fix append lines
  
END

PUBLIC SUB list_video_modes()
  
  WITH ME.cbVideoRes
      .Add(("Standard"))
      .Add(("Bootsplash Med"))
      .Add(("Bootsplash High"))
      .Add(("Bootsplash Extra High"))
  END WITH 
      
  
END





PUBLIC SUB Form_Menu()

  MdlLilo.GENERATE_LILO_DOT_CONF

END

PUBLIC SUB cbTimeOutSec_MouseDown()

  

END


PUBLIC SUB cbYNLilo_Click()
  DIM bVal AS Boolean
    IF LAST.value = TRUE THEN bval = FALSE
    IF LAST.value = FALSE THEN bval = TRUE
  WITH ME
    .tsLIloTabs.Enabled = bval
    .cbBootDefault.Enabled = bval
    .cbLIloTarget.Enabled = bval
     .cbVideoRes.Enabled = bval
     .SpinBox1.Enabled = bval
END WITH 
END


PUBLIC SUB cbVideoRes_Click()

  DIM tb AS TextBox
  DIM sText AS String
  
  IF NOT MdlLilo.arrLinuxAppendtxtBoxes THEN RETURN 
    SELECT CASE Trim(cbVideoRes.text)
      CASE (("Standard"))
          FOR EACH tb IN MdlLilo.arrLinuxAppendtxtBoxes
            tb.Text = Replace(tb.Text, "splash=silent", "") ' Not available on this mode
          NEXT 
      CASE ELSE 
        FOR EACH tb IN MdlLilo.arrLinuxAppendtxtBoxes
          IF InStr(tb.Text, "splash=") = FALSE THEN 
            IF tb.Tag <> "" THEN 
              IF tb.Text = "" THEN 
                  tb.Text = "splash=silent" 
                ELSE 
                       tb.Text = tb.Text & " splash=silent"
              END IF
              
            ELSE 
              tb.Text = "splash=silent"
            END IF
          END IF
        NEXT 
      END SELECT 
        
    

END

PUBLIC SUB Form_Show()

    FMain.tvPlan["Conf0"].Selected = TRUE
   FMain.tvPlan["Conf0"].Picture = MdlCore.sNowPic
   FMain.tvPlan["Inst1"].Picture = MdlCore.sDonePic 
   FMain.FrmCurr = ME
  'ME.Form_Open()

END
