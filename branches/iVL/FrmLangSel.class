' Gambas class file

'    This file is part of vinstall-ng

'    vinstall-ng is free software: you can redistribute it and/or modify
'    it under the terms of the GNU General Public License as published by
'    the Free Software Foundation, either version 2 of the License, or
'    (at your option) any later version.

'    vinstall-ng  is distributed in the hope that it will be useful,
'    but WITHOUT ANY WARRANTY; without even the implied warranty of
'    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
'    GNU General Public License for more details.

'    You should have received a copy of the GNU General Public License
'    along with vinstall-ng.  If not, see <http://www.gnu.org/licenses/>.



PUBLIC SUB Form_Open()

  
  FMain.tvPlan["Prep0"].Selected = TRUE

  FMain.FrmCurr = ME
  tlbanner.text = "<h3>" & tlbanner.text & "</h3>"
    
  'ME.lblangsel.Columns.Count = 2
      
    
ME.LIST_LANG_CHOICES()
END

PUBLIC SUB LIST_LANG_CHOICES()
  
  
  WITH ME.lblangsel
    .Add("es_ES", "Spanish")
    .Add("en_US", "US English")
    .Add("ru_RU.utf8", "Russian")
  END WITH 
  
  
'     DIM sLangCode, sLangName AS String
'     DIM i AS Integer
'     
'     i = 0
'     FOR EACH sLangCode IN Dir(".lang", "*.mo")
'       'Message(sLangCode)
'       SELECT CASE File.BaseName(".lang" &/ sLangCode)
'         CASE "en_US"
'           sLangName = "US English"
'         CASE "es"
'           sLangName = "Spanish"
'       END SELECT 
'       
'     ME.lblangsel.Add(File.BaseName(sLangCode), sLangName)
'     
'    
' NEXT 
'     
'   
END




PUBLIC SUB Form_Resize()

  WITH ME
    .tlBanner.Move(8, 4, MdlObjSizer.get_object_width(.tlBanner.text))
    .Separator1.Move(8, .tlBanner.top + .tlBanner.Height - .Separator1.Height, .ClientWidth - (.Separator1.Left * 2))
    .lbLangSel.Move(8, .tlBanner.top + .tlBanner.Height + 4)
   .lbLangSel.Resize((ME.Width / 3), ME.Height - (.tlBanner.Height * 2))
  END WITH 

END

PUBLIC SUB lbLangSel_Select()

  FMain.btnext.Enabled = TRUE
  'Message(LAST.current.key)

END



PUBLIC SUB lblangsel_Click()

  

END

PUBLIC SUB Form_Show()

  ME.Form_Open()

END
