' Gambas class file

'    This file is part of vinstall-ng

'    vinstall-ng is free software: you can redistribute it and/or modify
'    it under the terms of the GNU General Public License as published by
'    the Free Software Foundation, either version 2 of the License, or
'    (at your option) any later version.

'    vinstall-ng  is distributed in the hope that it will be useful,
'    but WITHOUT ANY WARRANTY; without even the implied warranty of
'    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
'    GNU General Public License for more details.

'    You should have received a copy of the GNU General Public License
'    along with vinstall-ng.  If not, see <http://www.gnu.org/licenses/>.


PUBLIC SUB Form_Open()

  WITH ME
    .tlBanner.Text = "Choose your installation mode"
      .rbFull_Click()
  END WITH 
  FMain.FrmCurr = ME
  FMain.tvPlan["Prep3"].Selected = TRUE
  FMain.tvPlan["Prep2"].Picture = MdlCore.sDonePic
  FMain.tvPlan["Prep3"].Picture = MdlCore.sNowPic
  FMain.btback.Enabled = TRUE
FMain.btback.ForeColor = Color.Black

END

PUBLIC SUB Form_Resize()

  WITH ME
    '.tlBanner.Width = .ClientWidth - 8
    .tlBanner.Move(4, 4, .ClientWidth - 8, 27)
    .rbFull.Move(.tlBanner.Left, .tlBanner.top + .tlBanner.Height + 8, MdlObjSizer.get_object_width(.rbfull.text) + 36)
    .rbCustom.Move(.tlBanner.Left, .rbFull.top + .rbFull.Height + 4, MdlObjSizer.get_object_width(.rbcustom.text) + 36)
    .tlActionDesc.Width = .tlBanner.Width - 4
    .scrlInstallOpts.Move(.tlActionDesc.Left, .tlActionDesc.top + .tlActionDesc.Height + 8, .tlActionDesc.Width - 12, .ClientHeight - (.tlActionDesc.top + (.tlActionDesc.height * 2.75)))
  
  END WITH 

END

PUBLIC SUB rbFull_Click()

  tlActionDesc.Text = "Installs everything in your VectorLinux media to your system"
  tlActionDesc.Adjust
  scrlInstallOpts.Visible = FALSE
  ClsPkgSel.bCustom = FALSE

END

PUBLIC SUB rbCustom_Click()

  tlActionDesc.Text = "Choose your optional components to install."
  tlActionDesc.Adjust
  scrlInstallOpts.Visible = TRUE
  MdlPkgSel.LIST_BULK_SELECTION
  ClsPkgSel.bCustom = TRUE

END

PUBLIC SUB Form_Hide()

  IF ClsPkgSel.bCustom = FALSE THEN
  
  FMain.tvPlan["Prep2"].Picture = MdlCore.sDonePic
  END IF
END

PUBLIC SUB Form_Show()

  Form_Open()

END
